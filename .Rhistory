log(0)
max(qty$qty_dna)
max(qty$qty_rna)
max(qty$qty_rna) %>% log
max(qty$qty_dna) %>% log
library(knitr)
library(survival)
library(lubridate)
library(ggsurvfit)
library(gtsummary)
library(tidycmprsk)
library(dplyr)
library(rms)
library(stringi)
library(survivalAnalysis)
library(purrr)
library(googlesheets4)
library(xddd)
library(ggpubr)
library(DataExplorer)
library(xlsx)
remove(list=ls())
qty <- read.xlsx("C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/Zani/ZANI/lab/lab_report.xlsx", sheetName = 'quantity')
# nanodrop_log <- read.xlsx()
qty <- qty %>% mutate(
master_sample_id = stri_extract_all_regex(sample_id, 'Z_\\d{1,2}_\\w', simplify = TRUE)[,1]
)
qty_dna <- qty  %>% filter(material == 'DNA') %>% select(master_sample_id, qty, qubit, tissue)
qty_rna <- qty %>% filter(material == 'RNA') %>% select(master_sample_id, qty, qubit)
qty_dna <- qty_dna %>% rename('qty_dna' = 'qty', 'qubit_dna' = 'qubit')
qty_rna <- qty_rna %>% rename('qty_rna' = 'qty', 'qubit_rna' = 'qubit')
qty <- merge(qty_dna, qty_rna, by = 'master_sample_id',all = TRUE)
qty_tumor <- qty %>% filter(tissue == 'tumor')
qty_control <- qty %>% filter(tissue == 'control')
histogram_tumor_dna <- ggplot(data = qty_tumor, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[3], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - tumor tissue') +
geom_vline(xintercept = 500, colour = 'yellow') + geom_vline(xintercept = 260, colour = 'orange')  +
geom_vline(xintercept = 60, colour = 'red')
histogram_tumor_rna <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[2], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - tumor tissue')
histogram_control_dna <- ggplot(data = qty_control, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[4], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - healthy control') +
geom_vline(xintercept = 250, colour = 'orange') + geom_vline(xintercept = 50, colour = 'red')
histogram_control_rna <- ggplot(data = qty_control, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[5], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - healthy control')
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
scale_x_continuous(limits = c(1, max(qty$qty_rna))) +
scale_y_continuous(limits = c(1, max(qty$qty_dna))) + scale_x_log10() + scale_y_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue')
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
scale_x_continuous(limits = c(1, max(qty$qty_rna))) +
scale_y_continuous(limits = c(1, max(qty$qty_dna))) + scale_x_log10() + scale_y_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control')
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
fig3
library(knitr)
library(survival)
library(lubridate)
library(ggsurvfit)
library(gtsummary)
library(tidycmprsk)
library(dplyr)
library(rms)
library(stringi)
library(survivalAnalysis)
library(purrr)
library(googlesheets4)
library(xddd)
library(ggpubr)
library(DataExplorer)
library(xlsx)
remove(list=ls())
qty <- read.xlsx("C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/Zani/ZANI/lab/lab_report.xlsx", sheetName = 'quantity')
# nanodrop_log <- read.xlsx()
qty <- qty %>% mutate(
master_sample_id = stri_extract_all_regex(sample_id, 'Z_\\d{1,2}_\\w', simplify = TRUE)[,1]
)
qty_dna <- qty  %>% filter(material == 'DNA') %>% select(master_sample_id, qty, qubit, tissue)
qty_rna <- qty %>% filter(material == 'RNA') %>% select(master_sample_id, qty, qubit)
qty_dna <- qty_dna %>% rename('qty_dna' = 'qty', 'qubit_dna' = 'qubit')
qty_rna <- qty_rna %>% rename('qty_rna' = 'qty', 'qubit_rna' = 'qubit')
qty <- merge(qty_dna, qty_rna, by = 'master_sample_id',all = TRUE)
qty_tumor <- qty %>% filter(tissue == 'tumor')
qty_control <- qty %>% filter(tissue == 'control')
histogram_tumor_dna <- ggplot(data = qty_tumor, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[3], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - tumor tissue') +
geom_vline(xintercept = 500, colour = 'yellow') + geom_vline(xintercept = 260, colour = 'orange')  +
geom_vline(xintercept = 60, colour = 'red')
histogram_tumor_rna <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[2], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - tumor tissue')
histogram_control_dna <- ggplot(data = qty_control, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[4], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - healthy control') +
geom_vline(xintercept = 250, colour = 'orange') + geom_vline(xintercept = 50, colour = 'red')
histogram_control_rna <- ggplot(data = qty_control, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[5], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - healthy control')
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
scale_x_continuous(limits = c(-1, max(qty$qty_rna))) +
scale_y_continuous(limits = c(-1, max(qty$qty_dna))) + scale_x_log10() + scale_y_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue')
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
scale_x_continuous(limits = c(-1, max(qty$qty_rna))) +
scale_y_continuous(limits = c(-1, max(qty$qty_dna))) + scale_x_log10() + scale_y_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control')
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
fig3
library(knitr)
library(survival)
library(lubridate)
library(ggsurvfit)
library(gtsummary)
library(tidycmprsk)
library(dplyr)
library(rms)
library(stringi)
library(survivalAnalysis)
library(purrr)
library(googlesheets4)
library(xddd)
library(ggpubr)
library(DataExplorer)
library(xlsx)
remove(list=ls())
qty <- read.xlsx("C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/Zani/ZANI/lab/lab_report.xlsx", sheetName = 'quantity')
# nanodrop_log <- read.xlsx()
qty <- qty %>% mutate(
master_sample_id = stri_extract_all_regex(sample_id, 'Z_\\d{1,2}_\\w', simplify = TRUE)[,1]
)
qty_dna <- qty  %>% filter(material == 'DNA') %>% select(master_sample_id, qty, qubit, tissue)
qty_rna <- qty %>% filter(material == 'RNA') %>% select(master_sample_id, qty, qubit)
qty_dna <- qty_dna %>% rename('qty_dna' = 'qty', 'qubit_dna' = 'qubit')
qty_rna <- qty_rna %>% rename('qty_rna' = 'qty', 'qubit_rna' = 'qubit')
qty <- merge(qty_dna, qty_rna, by = 'master_sample_id',all = TRUE)
qty_tumor <- qty %>% filter(tissue == 'tumor')
qty_control <- qty %>% filter(tissue == 'control')
histogram_tumor_dna <- ggplot(data = qty_tumor, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[3], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - tumor tissue') +
geom_vline(xintercept = 500, colour = 'yellow') + geom_vline(xintercept = 260, colour = 'orange')  +
geom_vline(xintercept = 60, colour = 'red')
histogram_tumor_rna <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[2], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - tumor tissue')
histogram_control_dna <- ggplot(data = qty_control, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[4], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - healthy control') +
geom_vline(xintercept = 250, colour = 'orange') + geom_vline(xintercept = 50, colour = 'red')
histogram_control_rna <- ggplot(data = qty_control, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[5], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - healthy control')
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
scale_x_continuous(limits = c(-1, max(qty$qty_rna))) +
scale_y_continuous(limits = c(-1, max(qty$qty_dna))) + scale_x_log10() + scale_y_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue')
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
scale_x_continuous(limits = c(-1, max(qty$qty_rna))) +
scale_y_continuous(limits = c(-1, max(qty$qty_dna))) + scale_x_log10() + scale_y_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control')
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
fig3
library(knitr)
library(survival)
library(lubridate)
library(ggsurvfit)
library(gtsummary)
library(tidycmprsk)
library(dplyr)
library(rms)
library(stringi)
library(survivalAnalysis)
library(purrr)
library(googlesheets4)
library(xddd)
library(ggpubr)
library(DataExplorer)
library(xlsx)
remove(list=ls())
qty <- read.xlsx("C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/Zani/ZANI/lab/lab_report.xlsx", sheetName = 'quantity')
# nanodrop_log <- read.xlsx()
qty <- qty %>% mutate(
master_sample_id = stri_extract_all_regex(sample_id, 'Z_\\d{1,2}_\\w', simplify = TRUE)[,1]
)
qty_dna <- qty  %>% filter(material == 'DNA') %>% select(master_sample_id, qty, qubit, tissue)
qty_rna <- qty %>% filter(material == 'RNA') %>% select(master_sample_id, qty, qubit)
qty_dna <- qty_dna %>% rename('qty_dna' = 'qty', 'qubit_dna' = 'qubit')
qty_rna <- qty_rna %>% rename('qty_rna' = 'qty', 'qubit_rna' = 'qubit')
qty <- merge(qty_dna, qty_rna, by = 'master_sample_id',all = TRUE)
qty_tumor <- qty %>% filter(tissue == 'tumor')
qty_control <- qty %>% filter(tissue == 'control')
histogram_tumor_dna <- ggplot(data = qty_tumor, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[3], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - tumor tissue') +
geom_vline(xintercept = 500, colour = 'yellow') + geom_vline(xintercept = 260, colour = 'orange')  +
geom_vline(xintercept = 60, colour = 'red')
histogram_tumor_rna <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[2], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - tumor tissue')
histogram_control_dna <- ggplot(data = qty_control, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[4], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - healthy control') +
geom_vline(xintercept = 250, colour = 'orange') + geom_vline(xintercept = 50, colour = 'red')
histogram_control_rna <- ggplot(data = qty_control, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[5], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - healthy control')
limits_x <- c(-1, max(qty$qty_rna, na.rm = TRUE))
limits_y <- c(-1, max(qty$qty_dna, na.rm = TRUE))
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
scale_x_log10(limits = limits_x) + scale_y_log10(limits = limits_y) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue')
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
scale_x_log10(limits = limits_x) + scale_y_log10(limits = limits_y) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control')
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
fig3
?scale_x_log10
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
scale_x_log10(limits = limits_x) + scale_y_log10(limits = limits_y) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue')
scatter_tumor
scatter_control
str(scatter_control)
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue') +
scale_x_log10(limits = limits_x) + scale_y_log10(limits = limits_y)
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control') +
scale_x_log10(limits = limits_x) + scale_y_log10(limits = limits_y)
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
fig3
limits_x <- c(-1, max(qty$qty_rna, na.rm = TRUE))
limits_y <- c(-1, max(qty$qty_dna, na.rm = TRUE))
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue') +
scale_x_log10(limits = limits_x) + scale_y_log10(limits = limits_y)
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control') +
scale_x_log10(limits = limits_x) + scale_y_log10(limits = limits_y)
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
limits_x <- c(-1, max(qty$qty_rna, na.rm = TRUE))
limits_y <- c(-1, max(qty$qty_dna, na.rm = TRUE))
fig3
max(qty$qty_rna, na.rm = TRUE)
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control') +
scale_x_log10(limits = c(-1, 76800)) + scale_y_log10(limits = limits_y)
scatter_control
fig3
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue') +
scale_x_log10(limits = limits_x, labels = label_style_number()) + scale_y_log10(limits = limits_y)
scatter_tumor
limits_x <- c(-1, max(qty$qty_rna, na.rm = TRUE))
limits_y <- c(-1, max(qty$qty_dna, na.rm = TRUE))
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue') +
scale_x_log10(limits = limits_x, labels = label_style_number()) + scale_y_log10(limits = limits_y)
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control') +
scale_x_log10(limits = limits_x, labels = label_style_number()) + scale_y_log10(limits = limits_y)
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
fig3
max(qty$qty_dna)
max(qty$qubit_dna)
qty$qubit_dna
as.numeric(qty$qubit_dna)
as.numeric(qty$qubit_dna) %>% max
156*76
install.packages("base64enc")
library(base64enc)
dataURI(file = 'C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/medstat/projects/researchgate.png', mime = 'image/png')
dataURI(file = 'C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/medstat/projects/researchgate.png', mime = 'image/png') %>% write(file = 'C:/Users/pbpol/OneDrive/Pulpit/researchgate.txt')
library(dplyr)
dataURI(file = 'C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/medstat/projects/researchgate.png', mime = 'image/png') %>% write(file = 'C:/Users/pbpol/OneDrive/Pulpit/researchgate.txt')
dataURI(file = 'C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/medstat/projects/ORCID_iD.png', mime = 'image/png') %>% write(file = 'C:/Users/pbpol/OneDrive/Pulpit/orcid.txt')
```{r, fig.asp=0.55}
library(knitr)
library(survival)
library(lubridate)
library(ggsurvfit)
library(gtsummary)
library(tidycmprsk)
library(dplyr)
library(rms)
library(stringi)
library(survivalAnalysis)
library(purrr)
library(googlesheets4)
library(xddd)
library(ggpubr)
library(DataExplorer)
library(xlsx)
remove(list=ls())
qty <- read.xlsx("C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/Zani/ZANI/lab/lab_report.xlsx", sheetName = 'quantity')
# nanodrop_log <- read.xlsx()
qty <- qty %>% mutate(
master_sample_id = stri_extract_all_regex(sample_id, 'Z_\\d{1,2}_\\w', simplify = TRUE)[,1]
)
qty_dna <- qty  %>% filter(material == 'DNA') %>% select(master_sample_id, qty, qubit, tissue)
qty_rna <- qty %>% filter(material == 'RNA') %>% select(master_sample_id, qty, qubit)
qty_dna <- qty_dna %>% rename('qty_dna' = 'qty', 'qubit_dna' = 'qubit')
qty_rna <- qty_rna %>% rename('qty_rna' = 'qty', 'qubit_rna' = 'qubit')
qty <- merge(qty_dna, qty_rna, by = 'master_sample_id',all = TRUE)
qty_tumor <- qty %>% filter(tissue == 'tumor')
qty_control <- qty %>% filter(tissue == 'control')
histogram_tumor_dna <- ggplot(data = qty_tumor, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[3], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - tumor tissue') +
geom_vline(xintercept = 500, colour = 'yellow') + geom_vline(xintercept = 260, colour = 'orange')  +
geom_vline(xintercept = 60, colour = 'red')
histogram_tumor_rna <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[2], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - tumor tissue')
histogram_control_dna <- ggplot(data = qty_control, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[4], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - healthy control') +
geom_vline(xintercept = 250, colour = 'orange') + geom_vline(xintercept = 50, colour = 'red')
histogram_control_rna <- ggplot(data = qty_control, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[5], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - healthy control')
limits_x <- c(-1, max(qty$qty_rna, na.rm = TRUE))
limits_y <- c(-1, max(qty$qty_dna, na.rm = TRUE))
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue') +
scale_x_log10(limits = limits_x, labels = label_style_number()) + scale_y_log10(limits = limits_y)
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control') +
scale_x_log10(limits = limits_x, labels = label_style_number()) + scale_y_log10(limits = limits_y)
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
fig1
fig2
fig3
fig3
```{r, fig.asp=0.35, fig.width=12}
fig3
```{r, fig.asp=0.35, fig.width=8}
fig3
```{r, fig.width=8}
fig3
fig2
```{r, fig.width=8, fig.asp=0.35}
fig2
fig2
fig2
fig2
fig1
library(knitr)
library(survival)
library(lubridate)
library(ggsurvfit)
library(gtsummary)
library(tidycmprsk)
library(dplyr)
library(rms)
library(stringi)
library(survivalAnalysis)
library(purrr)
library(googlesheets4)
library(xddd)
library(ggpubr)
library(DataExplorer)
library(xlsx)
remove(list=ls())
qty <- read.xlsx("C:/Users/pbpol/OneDrive/Dokumenty/NIO/robocze/Zani/ZANI/lab/lab_report.xlsx", sheetName = 'quantity')
# nanodrop_log <- read.xlsx()
qty <- qty %>% mutate(
master_sample_id = stri_extract_all_regex(sample_id, 'Z_\\d{1,2}_\\w', simplify = TRUE)[,1]
)
qty_dna <- qty  %>% filter(material == 'DNA') %>% select(master_sample_id, qty, qubit, tissue)
qty_rna <- qty %>% filter(material == 'RNA') %>% select(master_sample_id, qty, qubit)
qty_dna <- qty_dna %>% rename('qty_dna' = 'qty', 'qubit_dna' = 'qubit')
qty_rna <- qty_rna %>% rename('qty_rna' = 'qty', 'qubit_rna' = 'qubit')
qty <- merge(qty_dna, qty_rna, by = 'master_sample_id',all = TRUE)
qty_tumor <- qty %>% filter(tissue == 'tumor')
qty_control <- qty %>% filter(tissue == 'control')
limits_x <- c(-1, max(qty$qty_rna, na.rm = TRUE))
limits_y <- c(-1, max(qty$qty_dna, na.rm = TRUE))
histogram_tumor_dna <- ggplot(data = qty_tumor, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[3], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - tumor tissue') +
geom_vline(xintercept = 500, colour = 'yellow') + geom_vline(xintercept = 260, colour = 'orange')  +
geom_vline(xintercept = 60, colour = 'red')+
scale_x_log10(limits = limits_x, labels = label_style_number())
histogram_tumor_rna <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[2], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - tumor tissue')+
scale_x_log10(limits = limits_x, labels = label_style_number())
histogram_control_dna <- ggplot(data = qty_control, mapping = aes(x = qty_dna)) +
geom_histogram(color = "black", fill = palette.colors()[4], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'DNA quantity [ng] (log scale)', title = 'DNA quantity - healthy control') +
geom_vline(xintercept = 250, colour = 'orange') + geom_vline(xintercept = 50, colour = 'red')+
scale_x_log10(limits = limits_x, labels = label_style_number())
histogram_control_rna <- ggplot(data = qty_control, mapping = aes(x = qty_rna)) +
geom_histogram(color = "black", fill = palette.colors()[5], bins = 30) + scale_x_log10() +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)', title = 'RNA quantity - healthy control')+
scale_x_log10(limits = limits_x, labels = label_style_number())
scatter_tumor <- ggplot(data = qty_tumor, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[6], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - tumor tissue') +
scale_x_log10(limits = limits_x, labels = label_style_number()) + scale_y_log10(limits = limits_y)
scatter_control <- ggplot(data = qty_control, mapping = aes(x = qty_rna, y = qty_dna)) + theme_minimal() +
geom_point(color = "black", fill = palette.colors()[7], shape = 21, size = 2) +
theme_minimal() + labs(x = 'RNA quantity [ng] (log scale)',
y = 'DNA quantity [ng] (log scale)',
title = 'RNA vs DNA quantity - healthy control') +
scale_x_log10(limits = limits_x, labels = label_style_number()) + scale_y_log10(limits = limits_y)
fig1 <- ggarrange(histogram_tumor_dna, histogram_tumor_rna, ncol = 2)
fig2 <- ggarrange(histogram_control_dna, histogram_control_rna, ncol = 2)
fig3 <- ggarrange(scatter_tumor, scatter_control, ncol = 2)
fig1
fig2
nrow(qty)
table(qty$tissue)
sum(qty$tissue == 'tumor')
sum(qty$tissue == 'control')
length(unique(qty_tumor$master_sample_id))
Sys.Date()
Sys.Date()
print(Sys.Date())
perc <- function(x, perc_only=FALSE){
n_true <- sum(x,na.rm = TRUE)
n_tot <- length(x)
if(perc_only){
paste(round(100*n_true/n_tot, 1), '%', sep='')
}else{
paste(n_true, ' (', round(100*n_true/n_tot, 1), '%)', sep='')
}
}
qty_tumor <- qty %>% filter(tissue == 'tumor')
qty_control <- qty %>% filter(tissue == 'control')
perc(qty_tumor$qty_dna>500)
